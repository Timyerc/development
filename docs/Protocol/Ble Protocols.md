# 圆形擦窗机蓝牙通信协议

## 用户模式

### 手机发送数据包
| 字节 | 描述 | 值 |
| ----------- | ----------- | ----------- |
| 0 | 同步头 | 0xF5 |
| 1 | IP | 用户模式 手机获取IP的最后一个字节（0x01~0xFE）<br> 测试模式 0xFF |
| 2 | 控制指令 | 默认 0x00<br> OK 0x08<br> STOP 0x01<br> 手动向上 0x05<br> 手动向下 0x1B<br> 手动向左 0x07<br> 手动向右 0x09<br> 自动向上 0x12<br> 自动向左 0x1A<br> 自动向右 0x1E<br> 自动喷水 0x22<br> 手动喷水 0x23<br> 手动喷水开始 0x20<br> 手动喷水结束 0x21 |
| 3 | 速度档 | 速度挡1 0x00（默认）<br>速度档2 0x01<br> 速度档3 0x02 | 
| 4 | 间隔时间喷水模式<br> 喷水时间间隔 | 5s 0x00<br> 10s 0x01（默认）<br> 15s 0x02<br> 20s 0x03 |
| 5 | 喷水出厂测试 | 出厂测试持续喷水 0x01<br> 用户模式 0x00（默认）|
| 6~10 | 保留 | 0x00 |
***

### 设备反馈数据包
| 字节 | 描述 | 值 |
| ----------- | ----------- | ----------- |
| 0 | 同步头 | 0xEE |
| 1 | IP | 用户模式 手机获取IP的最后一个字节（0x01~0xFE） |
| 2 | 电量 | 0~100 |
| 3 | 信号强度 | 1~6 |
| 4 | LED指示灯 | 工作正常 0x00（默认）<br> 低电量 0x01<br> 马达保护 0x02|
| 5 | S60-7和S60-8：<br> 喷水功能标志<br> 其他：<br> 自动模式清洁完成标志 | S60-7：<br> 0x01<br> S60-8：<br> 0x02<br> 其他：<br> 工作中 0x00（默认）<br> 工作完成 0x01 |
| 6 | 机器状态 | 停止 0x00<br> 手动向上 0x01<br> 手动向下 0x02<br> 手动向右 0x03<br> 手动向左 0x04<br> 自动向上 0x07<br> 自动向下 0x08<br> 自动向左 0x09<br> 自动向右 0x0A |
| 7 | 喷水状态 | 手动 0x00（默认）<br> 自动 0x01|
| 8 | 喷水间隔时间等级 |  0~4 |
| 9~10 | 保留| |
***
## 测试模式

### 手机发送数据包
| 字节 | 描述 | 值 |
| ----------- | ----------- | ----------- |
| 0 | 同步头 | 0xF5 |
| 1 | IP | 用户模式 手机获取IP的最后一个字节（0x01~0xFE）<br> 测试模式 0xFF |
| 2 | 风机PWM输出 | 0~100 |
| 3 | 转盘运动 | 停止 0x00（默认）<br> 正转 0x01<br> 反转 0x02 |
| 4 | 陀螺仪校准 | 未校准 0x00（默认）<br> 校准 0x01 |
| 5 | 喷水开关 | 关喷水 0x00（默认）<br> 开喷水 0x01 |
| 6~10 | 保留 | 0x00 |
| 11 | 校验 | byte[12] = ~( byte[1] + byte[2] + …… + byte[11]) |
| 12 | 同步尾 | 0x5F |
***
### 设备反馈数据包
| 字节 | 描述 | 值 |
| ----------- | ----------- | ----------- |
| 0 | 同步头 | 0xEE |
| 1~2 | 左电机电流 | byte[2] << 8 \| byte[3] |
| 3~4 | 右电机电流 | byte[4] << 8 \| byte[5] |
| 5~6 | 陀螺仪Yaw | byte[6] << 8 \| byte[7] |
| 7~8 | 风机电流 | byte[8] << 8 \| byte[9] |
| 9~10 | 保留| |
| 11 | 校验 | byte[12] = ~( byte[1] + byte[2] + …… + byte[11]) |
| 12 | 同步尾 | 0xDD |
***